---
export interface Props {
  manga: {
    id: string;
    title: string;
    image: string;
  };
}

const { manga } = Astro.props;

// Function to convert image URL to proxy URL - use full backend URL
function getProxyUrl(originalUrl: string): string {
  return `http://localhost:3000/api/image?url=${encodeURIComponent(originalUrl)}`;
}
---

<div class="manga-card">
  <a href={`/manga/${manga.id}`}>
    <img src={getProxyUrl(manga.image)} alt={manga.title} class="manga-cover" />
    <h3 class="manga-title">{manga.title}</h3>
  </a>
</div>

<style>
  .manga-card {
    background-color: var(--card-bg);
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    transition: transform 0.2s;
  }
  
  .manga-card:hover {
    transform: translateY(-5px);
  }
  
  .manga-cover {
    width: 100%;
    height: 280px;
    object-fit: cover;
    background-color: #f0f0f0; /* Add a background color while loading */
  }
  
  .manga-title {
    padding: 10px;
    margin: 0;
    font-size: 1rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  
  a {
    text-decoration: none;
    color: inherit;
  }
</style>